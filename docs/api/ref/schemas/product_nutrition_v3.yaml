components:
  schemas:
    ProductNutritionDataV3:
      type: object
      title: Product Nutrition Data
      description: |
        Nutrition fields of a product

        Most of these properties are read-only.

        See [how to add nutrition data](https://openfoodfacts.github.io/openfoodfacts-server/api/ref-cheatsheet/#add-nutrition-facts-values-units-and-base)
      properties:
        nutrition:
          type: object
          description: |
            todo
          properties:
            nutrient_sets_index:
              type: object
              description: | 
                A hash to quickly retrieve the `nutrients_set` array id for a specific set or to see if a specific set exists.
      
                The given specific set is a combination of *preparation* + *per* + *source*.
              additionalProperties:
                type: integer
                minimum: 0
                description: |
                  The index of the wanted nutrient set of in the `nutrient_sets` array.

                  It should always be 0 or more.
                example: 0
              example: 
                "as_sold_100g_packaging": 0
                "as_sold_100g_manufacturer": 1
                "as_sold_100g_estimate": 2
                "as_sold_100g_computed": 3
                "prepared_Serving_packaging": 4
            nutrient_sets:
              type: array
              description: |
                An array of nutrient sets of the product.

                Each nutrient set represents a version of the nutrition facts, defined by a combination of:
                - the preparation state (e.g. *as sold* or *prepared*),
                - the reference quantity (*per 100g*, *per 100ml* or *per serving*), and
                - the source of the data (e.g. *packaging*, *manufacturer*, *estimate*).

                This structure allows capturing multiple nutritional profiles for a single product.
              items:
                type: object
                properties:
                  preparation:
                    type: string
                    enum:
                      - as sold
                      - prepared
                    description: |
                      Indicates whether the nutrition values refer to the product *as sold* or *prepared*.

                      The preparation state affects nutrient values.
                  per:
                    type: string
                    enum:
                      - 100g
                      - 100ml
                      - serving
                    description: |
                      The nutrition data on the package can be per serving, per 100g or per 100ml.

                      This is essential to understand if values in the `nutrients` object apply for a serving, for 100g or for 100ml.
                  per_quantity:
                    type: integer
                    minimum: 0
                    description: |
                      The nutrition data on the package can be per serving, per 100g or per 100ml.
                      When the data is given per serving, the actual quantity that defines one serving may vary 
                      between products and should be stored in this field.
  
                      This is essential to understand to which quantity values in `nutrients` apply for.

                      For example, if the label states "per 250g", then this field should be *250*.
                    example: 250
                  per_unit:
                    type: string
                    description: |
                      The nutrition data on the package can be per serving, per 100g or per 100ml.
                      When the data is given per serving, the actual unit that defines one serving may vary 
                      between products and should be stored in this field.
  
                      This is essential to understand to which quantity values in `nutrients` apply for.

                      For example, if the label states "per 250g", then this field should be *g*.
                    example: "g"
                  source:
                    type: string
                    enum:
                      - packaging
                      - manufacturer
                      - usda
                      - estimate
                      - preferred
                    description: |
                      The nutrition data of products can be obtained through several sources.

                      The *preferred* source takes values from multiple sources (by priority: manufacturer, packaging, usda, estimate) 
                      and normalizes all values to the same unit: g for weights, kJ for energy and energy-kj, kcal for energy-kcal.

                      The *preferred* source is the one used to display nutrition data of products.
                  source_description:
                    type: string
                    description: |
                      A description of the source used for this nutrition set.

                      This provides more information on how and when the source was used.
                    examples:
                      - USDA non-branded foods 2025/04
                      - Import from org-nestle-france through Equadis
                      - "Estimate from ingredients”, “Estimate from category: Olive oils"
                  last_updated_t:
                    type: integer
                    description: |
                      A timestamp indicating when this nutrition set was last updated.
                    examples:
                      - 1631270265
                      - 1512153487
                  nutrients:
                    type: object
                    description: |
                      All known nutrients for the product.

                      You can get all possible nutrients from the
                      [nutrients taxonomy](https://static.openfoodfacts.org/data/taxonomies/nutrients.json)

                      **FIXME** add more nutrients with description.
                    properties:
                      acidity:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      added-salt:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      added-sugars:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      alcohol:
                        description: |
                          Quantity of alcohol

                          (per 100g, per 100ml or per serving) in a standard unit (g or ml)
                        $ref: "../schemas/product_nutrient_values.yaml"
                      allulose:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      alpha-linolenic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      ammonium-chloride:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      arachidic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      arachidonic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      bcaa:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      behenic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      beta-alanine:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      beta-carotene:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      beta-glucan:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      bicarbonate:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      biotin:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      butyric-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      caffeine:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      calcium:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      calcium-iodate-anhydrous:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      capric-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml" 
                      caproic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      caprylic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      carbohydrates:
                        description: |
                          This is the available carbohydrates (excluding fiber), also known as net carbohydrates

                          (per 100g, per 100ml or per serving) in a standard unit (g or ml)
                        $ref: "../schemas/product_nutrient_values.yaml"
                      carbohydrates-total:
                        description: |
                          This follows the US / Canada definition of carbohydrates which includes fiber, also known as gross carbohydrates

                          (per 100g, per 100ml or per serving) in a standard unit (g or ml)
                        $ref: "../schemas/product_nutrient_values.yaml"
                      carbon-footprint:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      carbon-footprint-from-meat-or-fish:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      carnitine:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      casein:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      cassia-gum:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      cerotic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      chloride:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      chlorophyl:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      cholesterol:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      choline:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      choline-chloride:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      chromium:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      cocoa:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      collagen-meat-protein-ratio:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      copper:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      copper-II-sulphate-pentahydrate:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      creatine:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      crude-ash:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      crude-fat:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      crude-fibre:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      crude-protein:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      dihomo-gamma-linolenic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      docosahexaenoic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      dry-residue:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      eicosapentaenoic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      elaidic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      energy:
                        description: |
                          It is the same as `energy-kj` if we have it, or computed from `energy-kcal` otherwise

                          (per 100g or per serving) in kj
                        $ref: "../schemas/product_nutrient_values.yaml"
                      energy_from_fat:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      energy_kcal:
                        description: |
                          energy in kcal, if it is specified

                          (per 100g or per serving) in a standard unit (g or ml)
                        $ref: "../schemas/product_nutrient_values.yaml"
                      energy_kj:
                        description: |
                          energy in kj, if it is specified

                          (per 100g or per serving) in a standard unit (g or ml)
                        $ref: "../schemas/product_nutrient_values.yaml"
                      erucic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      erythritol:
                        $ref: "../schemas/product_nutrient_values.yaml"
                        description: |
                          erythritol is a polyol which is not providing any energy.
                          As such, it needs not be taken into account when computing
                          the energy of a product. Eryhtritol is now displayed on
                          nutrition facts sheet of some products, mainly in the USA.
                          This value is entered either by contributors, either by
                          imports.
                      fat:
                        description: |
                          Quantity of fat

                          (per 100g, per 100ml or per serving) in a standard unit (g or ml)
                        $ref: "../schemas/product_nutrient_values.yaml"
                      fiber:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      fluoride:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      folates:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      fructose:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      fruits-vegetables-legumes:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      fruits-vegetables-legumes-estimate-from-ingredients:
                        description: |
                          An estimate, from the ingredients list of the percentage of fruits, vegetable and legumes.
                          This is an important information for Nutri-Score (2023 version) computation.
                        $ref: "../schemas/product_nutrient_values.yaml"
                      fruits-vegetables-nuts:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      fruits-vegetables-nuts-dried:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      fruits-vegetables-estimate:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      fruits-vegetables-nuts-estimate-from-ingredients:
                        description: |
                          An estimate, from the ingredients list of the percentage of fruits, vegetable and nuts.
                          This is an important information for Nutri-Score (2021 version) computation.
                        $ref: "../schemas/product_nutrient_values.yaml"
                      galactose:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      gamma-linolenic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      gamma-oryzanol:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      glucose:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      glycemic-index:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      gondoic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      hydrogencarbonate:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      inositol:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      insoluble-fiber:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      iodine:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      iron:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      iron-II-sulphate-monohydrate:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      l-arginine:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      l-citrulline:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      l-cysteine:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      l-glutamine:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      l-glutathione:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      l-isoleucine:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      l-leucine:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      l-valine:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      lactose:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      lauric-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      lignoceric-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      linoleic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      magnesium:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      maltose:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      maltodextrins:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      manganese:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      manganous-sulphate-monohydrate:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      mead-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      melissic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      methylsulfonylmethane:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      moisture:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      molybdenum:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      monounsaturated-fat:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      montanic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      myristic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      nervonic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      nitrate:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      nitrite:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      nova-group:
                        description: |
                          todo -> remove
                        $ref: "../schemas/product_nutrient_values.yaml"
                      nucleotides:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      nutrition-score-fr:
                        description: |
                          Experimental nutrition score derived from
                          the UK FSA score and adapted for the French market
                          (formula defined by the team of Professor Hercberg).
                          todo -> remove
                        $ref: "../schemas/product_nutrient_values.yaml"
                      nutrition-score-uk:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      oleic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      oligosaccharide:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      omega-3-fat:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      omega-6-fat:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      omega-9-fat:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      palmitic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      pantothenic-acid:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      ph:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      phosphorus:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      phylloquinone:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      polydextrose:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      polyols:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      polyunsaturated-fat:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      potassium:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      potassium-iodide:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      proteins:
                        description: |
                          Quantity of proteins

                          (per 100g, per 100ml or per serving) in a standard unit (g or ml)
                        $ref: "../schemas/product_nutrient_values.yaml"
                      salt:
                        description: |
                          Quantity of salt

                          (per 100g, per 100ml or per serving) in a standard unit (g or ml)
                        $ref: "../schemas/product_nutrient_values.yaml"
                      saturated-fat:
                        description: |
                          Quantity of saturated fat

                          (per 100g, per 100ml or per serving) in a standard unit (g or ml)
                        $ref: "../schemas/product_nutrient_values.yaml"
                      selenium:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      serum-proteins:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      silica:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      sodium:
                        $ref: "../schemas/product_nutrient_values.yaml"
                        description: |
                          Quantity of sodium

                          (per 100g, per 100ml or per serving) in a standard unit (g or ml)
                      sodium-selenite:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      soluble-fiber:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      spermidine:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      starch:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      stearic-acid:
                          description: |
                            todo
                          $ref: "../schemas/product_nutrient_values.yaml"
                      sucrose:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      sugars:
                        $ref: "../schemas/product_nutrient_values.yaml"
                        description: |
                          Quantity of sugars

                          (per 100g, per 100ml or per serving) in a standard unit (g or ml)
                      sulphate:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      taurine:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      trans-fat:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      unsaturated-fat:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      vitamin-a:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      vitamin-b1:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      vitamin-b2:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      vitamin-b6:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      vitamin-b9:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      vitamin-b12:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      vitamin-c:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      vitamin-d:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      vitamin-e:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      vitamin-k:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      vitamin-pp:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      water:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      water-hardness:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      whole-grain:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      zinc:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
                      zinc-sulphate-monohydrate:
                        description: |
                          todo
                        $ref: "../schemas/product_nutrient_values.yaml"
            