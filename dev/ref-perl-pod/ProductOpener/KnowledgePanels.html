<html><head><title>ProductOpener::KnowledgePanels</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="simple.min" type="text/css" href="../simple.min.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Fri Nov 24 15:06:16 2023 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#initialize_knowledge_panels_options(_%24knowledge_panels_options_ref%2C_%24request_ref_)'>initialize_knowledge_panels_options( $knowledge_panels_options_ref, $request_ref )</a>
    <li class='indexItem indexItem2'><a href='#create_knowledge_panels(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_knowledge_panels( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc_(or_%22data%22)'>language code $target_lc (or &#34;data&#34;)</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
        <li class='indexItem indexItem4'><a href='#options_%24options_ref'>options $options_ref</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_values'>Return values</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#convert_multiline_string_to_singleline(%24line)'>convert_multiline_string_to_singleline($line)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#panel_id_%24panel_id'>panel id $panel_id</a>
        <li class='indexItem indexItem4'><a href='#panel_template_%24panel_template'>panel template $panel_template</a>
        <li class='indexItem indexItem4'><a href='#panel_data_reference_%24panel_data_ref_(optional%2C_can_be_an_empty_hash)'>panel data reference $panel_data_ref (optional, can be an empty hash)</a>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#extract_data_from_impact_estimator_best_recipe_(%24product_ref%2C_%24panel_data_ref)'>extract_data_from_impact_estimator_best_recipe ($product_ref, $panel_data_ref)</a>
    <li class='indexItem indexItem2'><a href='#compare_impact_estimator_data_to_category_average_(%24product_ref%2C_%24panel_data_ref%2C_%24target_cc)'>compare_impact_estimator_data_to_category_average ($product_ref, $panel_data_ref, $target_cc)</a>
    <li class='indexItem indexItem2'><a href='#create_ecoscore_panel_(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_ecoscore_panel ( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_environment_card_panel_(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_environment_card_panel ( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_manufacturing_place_panel_(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_manufacturing_place_panel ( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_health_card_panel_(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_health_card_panel ( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
        <li class='indexItem indexItem4'><a href='#options_reference_%24options_ref'>options reference $options_ref</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_nutriscore_panel_(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_nutriscore_panel ( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_nutrient_levels_panels_(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_nutrient_levels_panels ( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_nutrition_facts_table_panel_(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_nutrition_facts_table_panel ( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_serving_size_panel(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_serving_size_panel( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_physical_activities_panel_(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_physical_activities_panel ( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Data'>Data</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#Activity_energy_equivalent_of_task'>Activity energy equivalent of task</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_ingredients_panel_(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_ingredients_panel ( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_additives_panel_(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_additives_panel ( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_ingredients_analysis_panel_(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_ingredients_analysis_panel ( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#object_reference_%24object_ref'>object reference $object_ref</a>
        <li class='indexItem indexItem4'><a href='#taxonomy_%24tagtype'>taxonomy $tagtype</a>
        <li class='indexItem indexItem4'><a href='#tag_id_%24tagoid'>tag id $tagoid</a>
        <li class='indexItem indexItem4'><a href='#list_of_properties_%24properties_ref'>list of properties $properties_ref</a>
        <li class='indexItem indexItem4'><a href='#language_codes_%24target_lcs'>language codes $target_lcs</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_recommendation_panels_(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_recommendation_panels ( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_nova_panel_(_%24product_ref%2C_%24target_lc%2C_%24target_cc%2C_%24options_ref_)'>create_nova_panel ( $product_ref, $target_lc, $target_cc, $options_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_reference_%24product_ref'>product reference $product_ref</a>
        <li class='indexItem indexItem4'><a href='#language_code_%24target_lc'>language code $target_lc</a>
        <li class='indexItem indexItem4'><a href='#country_code_%24target_cc'>country code $target_cc</a>
      </ul>
    </ul>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>ProductOpener::KnowledgePanels - Generate product knowledge panels that can be requested through the API</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p>Apps can request through the API knowledge panels for one product.
They are returned in the same structured format for all panels.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>See https://docs.google.com/document/d/1vJ9gatmv8pCXxyOERmYD16jOKRWJpz1RaQQ5MEcTxms/edit</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="initialize_knowledge_panels_options(_$knowledge_panels_options_ref,_$request_ref_)"
>initialize_knowledge_panels_options( $knowledge_panels_options_ref,
$request_ref )</a></h2>

<p>Initialize the options for knowledge panels from parameters.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_knowledge_panels(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_knowledge_panels( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Create all knowledge panels for a product,
with strings (descriptions,
recommendations etc.) in a specific language,
and return them in an array of panels.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc_(or_&#34;data&#34;)"
>language code $target_lc (or &#34;data&#34;)</a></h4>

<p>Returned panels contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<p>If $target_lc is equal to &#34;data&#34;,
no strings are returned.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<p>Needed for some country specific panels like the Eco-Score.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="options_$options_ref"
>options $options_ref</a></h4>

<p>Defines how some panels should be created (or not created)</p>

<p>- deactivate_[panel_id] : do not create a default panel -- currently unimplemented - activate_[panel_id] : create an on demand panel -- currently only for physical_activities panel</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_values"
>Return values</a></h3>

<p>Panels are returned in the &#34;knowledge_panels_[$target_lc]&#34; hash of the product reference passed as input.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="convert_multiline_string_to_singleline($line)"
>convert_multiline_string_to_singleline($line)</a></h2>

<p>Helper function to allow to enter multiline strings in JSON templates.
The function converts the multiline string into a single line string.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'

>create_panel_from_json_template ( $panel_id,
$panel_template,
$panel_data_ref,
$product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates a knowledge panel from a JSON template.
The template is passed both the full product data + optional panel specific data.
The template is thus responsible for all the display logic (what to display and how to display it).</p>

<p>Some special features that are not included in the JSON format are supported:</p>

<p>1.
Relative links are converted to absolute links using the requested country / language subdomain</p>

<p>2.
Multiline strings can be included using backticks ` at the start and end of the multiline strings.
- The multiline strings will be converted to a single string.
- Quotes &#34; are automatically escaped unless they are already escaped</p>

<p>3.
Comments can be included by starting a line with // - Comments will be removed in the resulting JSON,
they are only intended to make the source template easier to understand.</p>

<p>4.
Trailing commas are removed - For each loops in templates can result in trailing commas when separating items in a list with a comma (e.g.
if want to generate a list of labels)</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="panel_id_$panel_id"
>panel id $panel_id</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="panel_template_$panel_template"
>panel template $panel_template</a></h4>

<p>Relative path to the the template panel file,
from the &#34;/templates&#34; directory.
e.g.
&#34;api/knowledge-panels/environment/ecoscore/agribalyse.tt.json&#34;</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="panel_data_reference_$panel_data_ref_(optional,_can_be_an_empty_hash)"
>panel data reference $panel_data_ref (optional,
can be an empty hash)</a></h4>

<p>Used to pass data that is necessary for the panel but is not contained in the product data.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<p>The Eco-Score depends on the country of the consumer (as the transport bonus/malus depends on it)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="extract_data_from_impact_estimator_best_recipe_($product_ref,_$panel_data_ref)"
>extract_data_from_impact_estimator_best_recipe ($product_ref,
$panel_data_ref)</a></h2>

<p>The impact estimator adds a lot of data to products.
This function extracts the data we need to display knowledge panels.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="compare_impact_estimator_data_to_category_average_($product_ref,_$panel_data_ref,_$target_cc)"
>compare_impact_estimator_data_to_category_average ($product_ref,
$panel_data_ref,
$target_cc)</a></h2>

<p>gen_top_tags_per_country.pl computes stats for categories for nutrients,
and now also for the extended ecoscore impacts computed by the impact estimator.</p>

<p>For a specific product,
this function finds the most specific category for which we have impact stats to compare with.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_ecoscore_panel_(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_ecoscore_panel ( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates a knowledge panel to describe the Eco-Score,
including sub-panels for the different components of the Eco-Score.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<p>The Eco-Score depends on the country of the consumer (as the transport bonus/malus depends on it)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_environment_card_panel_(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_environment_card_panel ( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates a knowledge panel card that contains all knowledge panels related to the environment.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<p>The Eco-Score depends on the country of the consumer (as the transport bonus/malus depends on it)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_manufacturing_place_panel_(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_manufacturing_place_panel ( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates a knowledge panel when we know the location of the manufacturing place,
usually through a packaging code.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<p>The Eco-Score depends on the country of the consumer (as the transport bonus/malus depends on it)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_health_card_panel_(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_health_card_panel ( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates a knowledge panel card that contains all knowledge panels related to health.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<p>We may display country specific recommendations from health authorities,
or country specific scores.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="options_reference_$options_ref"
>options reference $options_ref</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_nutriscore_panel_(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_nutriscore_panel ( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates knowledge panels to describe the Nutri-Score.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_nutrient_levels_panels_(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_nutrient_levels_panels ( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates knowledge panels for nutrient levels for fat,
saturated fat,
sugars and salt.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_nutrition_facts_table_panel_(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_nutrition_facts_table_panel ( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates a knowledge panel with the nutrition facts table.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_serving_size_panel(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_serving_size_panel( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates a knowledge panel with portion size.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_physical_activities_panel_(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_physical_activities_panel ( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates a knowledge panel to indicate how much time is needed to burn the calories of a product for various activities.</p>

<p>Description: https://en.wikipedia.org/wiki/Metabolic_equivalent_of_task</p>

<p>1 MET = (kJ / 4.2) / (kg * hour)</p>

<p>Data: https://sites.google.com/site/compendiumofphysicalactivities/</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Data"
>Data</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="Activity_energy_equivalent_of_task"
>Activity energy equivalent of task</a></h4>

<p>Data: https://sites.google.com/site/compendiumofphysicalactivities/</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_ingredients_panel_(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_ingredients_panel ( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates a knowledge panel with the list of ingredients.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_additives_panel_(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_additives_panel ( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates knowledge panels for additives.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_ingredients_analysis_panel_(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_ingredients_analysis_panel ( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates a knowledge panel with the results of ingredients analysis.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'

>add_taxonomy_properties_in_target_languages_to_object ( $object_ref,
$tagtype,
$tagid,
$properties_ref,
$target_lcs_ref )</a></h2>

<p>This function adds to the hash ref $object_ref (for instance a data structure passed to a template) the values of selected properties,
if they exist in one of the target languages.</p>

<p>For instance for the panel for an additive,
we can include a Wikipedia abstract in the requested language if available,
or in English if not.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="object_reference_$object_ref"
>object reference $object_ref</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="taxonomy_$tagtype"
>taxonomy $tagtype</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="tag_id_$tagoid"
>tag id $tagoid</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="list_of_properties_$properties_ref"
>list of properties $properties_ref</a></h4>

<p>Properties to add to the resulting object.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_codes_$target_lcs"
>language codes $target_lcs</a></h4>

<p>Reference to an array of preferred languages,
with the preferred language first.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_recommendation_panels_(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_recommendation_panels ( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates knowledge panels with recommendations (e.g.
related to health or the environment).
Recommendations can depend on product properties (e.g.
categories or ingredients) and user properties (e.g.
country and language to get country specific recommendations,
but possibly also user preferences regarding trusted sources of information).</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_nova_panel_(_$product_ref,_$target_lc,_$target_cc,_$options_ref_)"
>create_nova_panel ( $product_ref,
$target_lc,
$target_cc,
$options_ref )</a></h2>

<p>Creates knowledge panels to describe the NOVA groups / processing / ultra-processing</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_reference_$product_ref"
>product reference $product_ref</a></h4>

<p>Loaded from the MongoDB database,
Storable files,
or the OFF API.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="language_code_$target_lc"
>language code $target_lc</a></h4>

<p>Returned attributes contain both data and strings intended to be displayed to users.
This parameter sets the desired language for the user facing strings.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="country_code_$target_cc"
>country code $target_cc</a></h4>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
