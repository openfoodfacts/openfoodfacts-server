<html><head><title>ProductOpener::Mail</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="simple.min" type="text/css" href="../simple.min.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Mon Nov 20 17:23:08 2023 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#CONSTANTS'>CONSTANTS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#LOG_EMAIL_START_Text_used_before_logging_an_email'>LOG_EMAIL_START Text used before logging an email</a>
    <li class='indexItem indexItem2'><a href='#LOG_EMAIL_END_Text_used_after_logging_an_email'>LOG_EMAIL_END Text used after logging an email</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#_send_email(%24mail)'>_send_email($mail)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#Email%3A%3AStuffer_object_%24mail'>Email::Stuffer object $mail</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#send_email(_USER_REF%2C_SUBJECT%2C_TEXT_)'>send_email( USER_REF, SUBJECT, TEXT )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#Input_keys%3A_user_data'>Input keys: user data</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_Values'>Return Values</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#send_html_email(_USER_REF%2C_SUBJECT%2C_HTML_CONTENT_)'>send_html_email( USER_REF, SUBJECT, HTML_CONTENT )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#Input_keys%3A_user_data'>Input keys: user data</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_Values'>Return Values</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#get_html_email_content_(%24filename%2C_%24lang_)'>get_html_email_content ($filename, $lang )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24filename'>$filename</a>
        <li class='indexItem indexItem4'><a href='#%24lang'>$lang</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_Values'>Return Values</a>
    </ul>
  </ul>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#send_email_to_admin(_SUBJECT%2C_TEXT_)'>send_email_to_admin( SUBJECT, TEXT )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <li class='indexItem indexItem3'><a href='#Return_Values'>Return Values</a>
    </ul>
  </ul>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#send_email_to_producers_admin(_SUBJECT%2C_TEXT_)'>send_email_to_producers_admin( SUBJECT, TEXT )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <li class='indexItem indexItem3'><a href='#Return_Values'>Return Values</a>
    </ul>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>ProductOpener::Mail - sends emails to admin and producers.
Moreover,
replies to user queries.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p><code>ProductOpener::Mail</code> is used to send emails from the contact address of the Open Food Facts to users,
admin,
and producers.</p>

<pre>    use ProductOpener::Mail qw/:all/;

        $contact_email = &#39;contact@openbeautyfacts.org&#39;;
        $admin_email = &#39;stephane@openfoodfacts.org&#39;;
        $producers_email = &#39;producers@openfoodfacts.org&#39;;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The module implements the sending of emails from the Open Food Facts contact email address to users, admin, and producers. These emails can be used to reply to user queries, submit feedback, or to request access from admin and producers.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CONSTANTS"
>CONSTANTS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="LOG_EMAIL_START_Text_used_before_logging_an_email"
>LOG_EMAIL_START Text used before logging an email</a></h2>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="LOG_EMAIL_END_Text_used_after_logging_an_email"
>LOG_EMAIL_END Text used after logging an email</a></h2>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_send_email($mail)"
>_send_email($mail)</a></h2>

<p>Secure way to send an email (private method)</p>

<p>Depending on $log_emails configuration it might just log the email instead of sending it.</p>

<p>Errors are logged.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="Email::Stuffer_object_$mail"
>Email::Stuffer object $mail</a></h4>

<p>The email should be ready to be send</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="send_email(_USER_REF,_SUBJECT,_TEXT_)"
>send_email( USER_REF, SUBJECT, TEXT )</a></h2>

<p><code>send_email()</code> sends a plain text email from the contact email of Open Food Facts to the email passed as an argument.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<p>The first argument is a hash reference. The other two arguments are scalar variables that consist of email subject and body.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="Input_keys:_user_data"
>Input keys: user data</a></h4>

<p>The hash must contain values for the following keys:</p>

<p>- email -&#62; user email - name -&#62; user name</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_Values"
>Return Values</a></h3>

<p>The function returns a 1 or 0 depending on the evaluation of the email sent or not.</p>

<p>If the function catches any error during evaluation it returns 1 indicating an error. On the other hand, if there was no error, it returns 0 indicating that the email has been sent successfully.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="send_html_email(_USER_REF,_SUBJECT,_HTML_CONTENT_)"
>send_html_email( USER_REF, SUBJECT, HTML_CONTENT )</a></h2>

<p><code>send_html_email()</code> sends an HTML email from the contact email of Open Food Facts to the email passed as an argument.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<p>The first argument is a hash reference. The other two arguments are scalar variables that consist of email subject and HTML content.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="Input_keys:_user_data"
>Input keys: user data</a></h4>

<p>The hash must contain values for the following keys:</p>

<p>- email -&#62; user email - name -&#62; user name</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_Values"
>Return Values</a></h3>

<p>The function returns a 1 or 0 depending on the evaluation of the email sent or not.</p>

<p>If the function catches any error during evaluation it returns 1 indicating an error. On the other hand, if there was no error, it returns 0 indicating that the email has been sent successfully.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_html_email_content_($filename,_$lang_)"
>get_html_email_content ($filename, $lang )</a></h2>

<p>Fetch the HTML email content in $DATA_ROOT/lang/emails. If a translation is available for the requested language, we provide the translated version otherwise English is the default.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$filename"
>$filename</a></h4>

<p>The HTML file name (ex: user_welcome.html)</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$lang"
>$lang</a></h4>

<p>The 2-letter language code</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_Values"
>Return Values</a></h3>

<p>The HTML string or undef if the file does not exists or is not readable.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="send_email_to_admin(_SUBJECT,_TEXT_)"
>send_email_to_admin( SUBJECT, TEXT )</a></h2>

<p><code>send_email_to_admin()</code> sends email from the contact email of Open Food Facts to the admin.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<p>Two scalar variables that contain the email subject and body are passed as an argument.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_Values"
>Return Values</a></h3>

<p>The function returns a 1 or 0 depending on the evaluation of the email sent or not.</p>

<p>If the function catches any error during evaluation it returns 1 indicating an error. On the other hand, if there was no error, it returns 0 indicating that the email has been sent successfully.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="send_email_to_producers_admin(_SUBJECT,_TEXT_)"
>send_email_to_producers_admin( SUBJECT, TEXT )</a></h2>

<p><code>send_email_to_producers_admin()</code> sends email from the contact email of Open Food Facts to producers admin.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<p>Two scalar variables that contain the email subject and body are passed as an argument.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_Values"
>Return Values</a></h3>

<p>The function returns a 1 or 0 depending on the evaluation of email sent or not.</p>

<p>If the function catches any error during evaluation it returns 1 indicating an error. On the other hand, if there was no error, it returns 1 indicating that email has sent successfully.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
