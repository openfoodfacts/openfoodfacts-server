<html><head><title>ProductOpener::Tags</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="simple.min" type="text/css" href="../simple.min.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.43,
  using Pod::Simple::PullParser v3.43,
  under Perl v5.038002 at Mon Oct 20 12:43:28 2025 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#GLOBAL_VARIABLES'>GLOBAL VARIABLES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#%25tags_fields'>%tags_fields</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#get_property_from_tags_(%24tagtype%2C_%24tags_ref%2C_%24property)'>get_property_from_tags ($tagtype, $tags_ref, $property)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Parameters'>Parameters</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24tags_ref_Reference_to_a_list_of_tags'>$tags_ref Reference to a list of tags</a>
        <li class='indexItem indexItem4'><a href='#%24property'>$property</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#get_inherited_property_from_tags_(%24tagtype%2C_%24tags_ref%2C_%24property)'>get_inherited_property_from_tags ($tagtype, $tags_ref, $property)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Parameters'>Parameters</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24tags_ref_Reference_to_a_list_of_tags'>$tags_ref Reference to a list of tags</a>
        <li class='indexItem indexItem4'><a href='#%24property'>$property</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_values'>Return values</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24property_value'>$property_value</a>
        <li class='indexItem indexItem4'><a href='#%24matching_tagid'>$matching_tagid</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#get_matching_regexp_property_from_tags_(%24tagtype%2C_%24tags_ref%2C_%24property%2C_%24regexp)'>get_matching_regexp_property_from_tags ($tagtype, $tags_ref, $property, $regexp)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Parameters'>Parameters</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24tags_ref_Reference_to_a_list_of_tags'>$tags_ref Reference to a list of tags</a>
        <li class='indexItem indexItem4'><a href='#%24property'>$property</a>
        <li class='indexItem indexItem4'><a href='#%24regexp'>$regexp</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#get_inherited_property_from_categories_tags_(%24product_ref%2C_%24property)_%7B'>get_inherited_property_from_categories_tags ($product_ref, $property) {</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Parameters'>Parameters</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24product_ref_-_the_product_reference'>$product_ref - the product reference</a>
        <li class='indexItem indexItem4'><a href='#%24property_-_the_property_-_string'>$property - the property - string</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return'>Return</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24property_value'>$property_value</a>
        <li class='indexItem indexItem4'><a href='#%24matching_category_id'>$matching_category_id</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#get_inherited_properties_(%24tagtype%2C_%24canon_tagid%2C_%24properties_names_ref%2C_%24fallback_lcs_%3D_%5B%22xx%22%2C_%22en%22%5D)_%7B'>get_inherited_properties ($tagtype, $canon_tagid, $properties_names_ref, $fallback_lcs = [&#34;xx&#34;, &#34;en&#34;]) {</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Parameters'>Parameters</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tagtype_-_str%2C_name_of_taxonomy'>$tagtype - str, name of taxonomy</a>
        <li class='indexItem indexItem4'><a href='#%24canon_tagid_-_tag_id_for_which_we_want_properties'>$canon_tagid - tag id for which we want properties</a>
        <li class='indexItem indexItem4'><a href='#%24properties_names_-_ref_to_a_list_of_property_name'>$properties_names - ref to a list of property name</a>
        <li class='indexItem indexItem4'><a href='#%24fallback_lcs_-_fallback_language_code_to_try'>$fallback_lcs - fallback language code to try</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return'>Return</a>
      <li class='indexItem indexItem3'><a href='#Return'>Return</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#Example'>Example</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#get_all_tags_having_property_(%24product_ref%2C_%24tagtype%2C_%24prop_name)'>get_all_tags_having_property ($product_ref, $tagtype, $prop_name)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Return'>Return</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#Example%2C_get_all_tags_having_property(%24product_ref%2C_%22labels%22%2C_%22incompatible_with%3Aen%22)'>Example, get_all_tags_having_property($product_ref, &#34;labels&#34;, &#34;incompatible_with:en&#34;)</a>
      </ul>
    </ul>
  </ul>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#add_tag'>add_tag</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24product_ref'>$product_ref</a>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24tagid'>$tagid</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#remove_stopwords_from_start_or_end_of_string_(_%24tagtype%2C_%24lc%2C_%24string_)'>remove_stopwords_from_start_or_end_of_string ( $tagtype, $lc, $string )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24lc_-_Language_code'>$lc - Language code</a>
        <li class='indexItem indexItem4'><a href='#%24string_-_string'>$string - string</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#remove_stopwords_(_%24tagtype%2C_%24lc%2C_%24tagid_)'>remove_stopwords ( $tagtype, $lc, $tagid )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24lc_-_Language_code'>$lc - Language code</a>
        <li class='indexItem indexItem4'><a href='#%24tagid_-_normalized_tag'>$tagid - normalized tag</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#sanitize_taxonomy_line(_%24line_)'>sanitize_taxonomy_line( $line )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#str_%24line_-_the_line_read_from_the_file'>str $line - the line read from the file</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#get_lc_tagid(_%24synonyms_ref%2C_%24lc%2C_%24tagtype%2C_%24tag%2C_%24warning_)'>get_lc_tagid( $synonyms_ref, $lc, $tagtype, $tag, $warning )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#str_%24tag_-_tag_string_for_which_we_search'>str $tag - tag string for which we search</a>
        <li class='indexItem indexItem4'><a href='#reference_to_hash_map_%24synonyms_ref_-_ref_to_%25synonyms_for_%24tagtype'>reference to hash map $synonyms_ref - ref to %synonyms for $tagtype</a>
        <li class='indexItem indexItem4'><a href='#str_%24tagtype_-_tag_type'>str $tagtype - tag type</a>
        <li class='indexItem indexItem4'><a href='#str_%24lc_-_language'>str $lc - language</a>
        <li class='indexItem indexItem4'><a href='#str_%24warning'>str $warning</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#return_str_-_found_current_tagid_or_undef'>return str - found current tagid or undef</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#build_tags_taxonomy(_%24tagtype%2C_%24file%2C_%24publish)'>build_tags_taxonomy( $tagtype, $file, $publish)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#str_%24tagtype_-_the_tagtype'>str $tagtype - the tagtype</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#%24file_-_name_of_the_file_to_read_in_taxonomies_folder'>$file - name of the file to read in taxonomies folder</a>
      <li class='indexItem indexItem3'><a href='#%24publish_-_if_1%2C_store_the_result_in_sto'>$publish - if 1, store the result in sto</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#build_all_taxonomies_(_%24pubish)'>build_all_taxonomies ( $pubish)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Parameters'>Parameters</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#Publish_STO_file_%24publish'>Publish STO file $publish</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#generate_tags_taxonomy_extract_(_%24tagtype%2C_%24tags_ref%2C_%24options_ref%2C_%24lcs_ref)'>generate_tags_taxonomy_extract ( $tagtype, $tags_ref, $options_ref, $lcs_ref)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Parameters'>Parameters</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#tag_type_%24tagtype'>tag type $tagtype</a>
        <li class='indexItem indexItem4'><a href='#reference_to_a_list_of_tags_ids_%24tags_ref'>reference to a list of tags ids $tags_ref</a>
        <li class='indexItem indexItem4'><a href='#reference_to_a_hash_of_key%2Fvalue_options'>reference to a hash of key/value options</a>
        <li class='indexItem indexItem4'><a href='#reference_to_an_array_of_language_codes'>reference to an array of language codes</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#init_taxonomies(%24die_if_some_taxonomies_cannot_be_loaded_%3D_0)'>init_taxonomies($die_if_some_taxonomies_cannot_be_loaded = 0)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Parameters'>Parameters</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#die_if_some_taxonomies_cannot_be_loaded_%24die_if_some_taxonomies_cannot_be_loaded'>die if some taxonomies cannot be loaded $die_if_some_taxonomies_cannot_be_loaded</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#canonicalize_taxonomy_tag_link_(%24target_lc%2C_%24tagtype%2C_%24tag%2C_%24tag_prefix_%3D_undef)'>canonicalize_taxonomy_tag_link ($target_lc, $tagtype, $tag, $tag_prefix = undef)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24tagid'>$tagid</a>
        <li class='indexItem indexItem4'><a href='#%24tag_prefix_(optional)'>$tag_prefix (optional)</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#get_tag_image_(_%24target_lc%2C_%24tagtype%2C_%24canon_tagid_)'>get_tag_image ( $target_lc, $tagtype, $canon_tagid )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24target_lc'>$target_lc</a>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24canon_tagid'>$canon_tagid</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#display_tags_hierarchy_taxonomy_(_%24target_lc%2C_%24tagtype%2C_%24tags_ref_)'>display_tags_hierarchy_taxonomy ( $target_lc, $tagtype, $tags_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24target_lc'>$target_lc</a>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24tags_ref'>$tags_ref</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#list_taxonomy_tags_in_language_(_%24target_lc%2C_%24tagtype%2C_%24tags_ref_)'>list_taxonomy_tags_in_language ( $target_lc, $tagtype, $tags_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24target_lc'>$target_lc</a>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24tags_ref'>$tags_ref</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#canonicalize_taxonomy_tag_or_die_(%24tag_lc%2C_%24tagtype%2C_%24tag)'>canonicalize_taxonomy_tag_or_die ($tag_lc, $tagtype, $tag)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tag_lc'>$tag_lc</a>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24tag'>$tag</a>
        <li class='indexItem indexItem4'><a href='#%24exists_in_taxonomy_ref'>$exists_in_taxonomy_ref</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#canonicalize_taxonomy_tag_(%24tag_lc%2C_%24tagtype%2C_%24tag%2C_%24exists_in_taxonomy_ref_%3D_undef)'>canonicalize_taxonomy_tag ($tag_lc, $tagtype, $tag, $exists_in_taxonomy_ref = undef)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tag_lc'>$tag_lc</a>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24tag'>$tag</a>
        <li class='indexItem indexItem4'><a href='#%24exists_in_taxonomy_ref'>$exists_in_taxonomy_ref</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#get_taxonomy_tag_synonyms_(_%24tagtype_)'>get_taxonomy_tag_synonyms ( $tagtype )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24canon_tagid'>$canon_tagid</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_values'>Return values</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#get_taxonomy_tag_synonyms_(_%24target_lc%2C_%24tagtype%2C_%24canon_tagid_)'>get_taxonomy_tag_synonyms ( $target_lc, $tagtype, $canon_tagid )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24target_lc'>$target_lc</a>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24canon_tagid'>$canon_tagid</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_values'>Return values</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#cached_display_taxonomy_tag_(_%24target_lc%2C_%24tagtype%2C_%24canon_tagid_)'>cached_display_taxonomy_tag ( $target_lc, $tagtype, $canon_tagid )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24target_lc_-_target_language_code'>$target_lc - target language code</a>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24canon_tagid'>$canon_tagid</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_values'>Return values</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#display_taxonomy_tag_(_%24target_lc%2C_%24tagtype%2C_%24canon_tagid_)'>display_taxonomy_tag ( $target_lc, $tagtype, $canon_tagid )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24target_lc_-_target_language_code'>$target_lc - target language code</a>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24canon_tagid'>$canon_tagid</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_values'>Return values</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#display_taxonomy_tag_name_(_%24target_lc%2C_%24tagtype%2C_%24canon_tagid_)'>display_taxonomy_tag_name ( $target_lc, $tagtype, $canon_tagid )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24target_lc_-_target_language_code'>$target_lc - target language code</a>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24canon_tagid'>$canon_tagid</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_values'>Return values</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#canonicalize_tag_link_(%24tagtype%2C_%24tagid%2C_%24tag_prefix_%3D_undef)'>canonicalize_tag_link ($tagtype, $tagid, $tag_prefix = undef)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24tagid'>$tagid</a>
        <li class='indexItem indexItem4'><a href='#%24tag_prefix_(optional)'>$tag_prefix (optional)</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#generate_regexps_matching_taxonomy_entries(%24taxonomy%2C_%24return_type%2C_%24options_ref)'>generate_regexps_matching_taxonomy_entries($taxonomy, $return_type, $options_ref)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24taxonomy'>$taxonomy</a>
        <li class='indexItem indexItem4'><a href='#%24return_type_-_string'>$return_type - string</a>
        <li class='indexItem indexItem4'><a href='#%24options_ref'>$options_ref</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#cmp_taxonomy_tags_alphabetically(%24tagtype%2C_%24target_lc%2C_%24a%2C_%24b)'>cmp_taxonomy_tags_alphabetically($tagtype, $target_lc, $a, $b)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24target_lc'>$target_lc</a>
        <li class='indexItem indexItem4'><a href='#%24a'>$a</a>
        <li class='indexItem indexItem4'><a href='#%24b'>$b</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#load_knowledge_content()'>load_knowledge_content()</a>
    <li class='indexItem indexItem2'><a href='#get_knowledge_content_(%24tagtype%2C_%24tagid%2C_%24target_lc%2C_%24target_cc)'>get_knowledge_content ($tagtype, $tagid, $target_lc, $target_cc)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24tagid'>$tagid</a>
        <li class='indexItem indexItem4'><a href='#%24target_lc'>$target_lc</a>
        <li class='indexItem indexItem4'><a href='#%24target_cc'>$target_cc</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#create_property_to_tag_mapping_table_(%24tagtype%2C_%24property)'>create_property_to_tag_mapping_table ($tagtype, $property)</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%24tagtype'>$tagtype</a>
        <li class='indexItem indexItem4'><a href='#%24property'>$property</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>ProductOpener::Tags - multilingual tags taxonomies (hierarchies of tags)</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p><code>ProductOpener::Tags</code> provides functions to build multilingual tags taxonomies from source files,
to use those taxonomies to canonicalize lists of tags,
and to display them in different languages.</p>

<pre>    use ProductOpener::Tags qw/:all/;</pre>

<p>..</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>..</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="GLOBAL_VARIABLES"
>GLOBAL VARIABLES</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="%tags_fields"
>%tags_fields</a></h2>

<p>This defines which are the fields that are list of values. To this initial list, taxonomized fields will be added by retrieve_tags_taxonomy</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_property_from_tags_($tagtype,_$tags_ref,_$property)"
>get_property_from_tags ($tagtype, $tags_ref, $property)</a></h2>

<p>Return the value of a property for the first tag of a list that has this property.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Parameters"
>Parameters</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tags_ref_Reference_to_a_list_of_tags"
>$tags_ref Reference to a list of tags</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$property"
>$property</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_inherited_property_from_tags_($tagtype,_$tags_ref,_$property)"
>get_inherited_property_from_tags ($tagtype, $tags_ref, $property)</a></h2>

<p>Return the value of an inherited property for the first tag of a list that has this property, and the corresponding matching tag.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Parameters"
>Parameters</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tags_ref_Reference_to_a_list_of_tags"
>$tags_ref Reference to a list of tags</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$property"
>$property</a></h4>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_values"
>Return values</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$property_value"
>$property_value</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$matching_tagid"
>$matching_tagid</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_matching_regexp_property_from_tags_($tagtype,_$tags_ref,_$property,_$regexp)"
>get_matching_regexp_property_from_tags ($tagtype, $tags_ref, $property, $regexp)</a></h2>

<p>Return the value of a property for the first tag of a list that has this property that matches the regexp.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Parameters"
>Parameters</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tags_ref_Reference_to_a_list_of_tags"
>$tags_ref Reference to a list of tags</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$property"
>$property</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$regexp"
>$regexp</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_inherited_property_from_categories_tags_($product_ref,_$property)_{"
>get_inherited_property_from_categories_tags ($product_ref, $property) {</a></h2>

<p>Iterating from the most specific category, try to get a property for a tag by exploring the taxonomy (using parents).</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Parameters"
>Parameters</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$product_ref_-_the_product_reference"
>$product_ref - the product reference</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$property_-_the_property_-_string"
>$property - the property - string</a></h4>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return"
>Return</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$property_value"
>$property_value</a></h4>

<p>The property value if found.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$matching_category_id"
>$matching_category_id</a></h4>

<p>The matching category id if we found a property value.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_inherited_properties_($tagtype,_$canon_tagid,_$properties_names_ref,_$fallback_lcs_=_[&#34;xx&#34;,_&#34;en&#34;])_{"
>get_inherited_properties ($tagtype, $canon_tagid, $properties_names_ref, $fallback_lcs = [&#34;xx&#34;, &#34;en&#34;]) {</a></h2>

<p>Try to get a set of properties for a tag by exploring the taxonomy (using parents).</p>

<p>This methods take into account if a property is defined as &#34;undef&#34; (but it cuts value only for the considered branch and might still lead to a value if there are multiple parents branches).</p>

<p><b>Warning:</b> The algorithm is a bit rough and my not work as you would expect on a DAG. It does not (currently) respect exploration of nodes that joins from multiple parent (in those case you would expect to first explore children from both branches). If we want to change the algorithm for this to work we should first explore parents, and then decide the order, but this methods is more eager to save time.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Parameters"
>Parameters</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype_-_str,_name_of_taxonomy"
>$tagtype - str, name of taxonomy</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$canon_tagid_-_tag_id_for_which_we_want_properties"
>$canon_tagid - tag id for which we want properties</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$properties_names_-_ref_to_a_list_of_property_name"
>$properties_names - ref to a list of property name</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$fallback_lcs_-_fallback_language_code_to_try"
>$fallback_lcs - fallback language code to try</a></h4>

<p>If may search a description:fr but if fallback is [&#39;xx&#39;, &#39;en&#39;] and we find a description:xx or description:en property we will use this value.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return"
>Return</a></h3>

<p>A ref to a hashmap where keys are property names and values are found value. If a property name is not present it means it was not found.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'

>get_tags_grouped_by_property ($tagtype, $tagids_ref, $prop_name, $props_ref, $inherited_props_ref, $fallback_lcs = [&#34;xx&#34;, &#34;en&#34;])</a></h2>

<p>Retrieve properties of a series of tags given in <code>$tagids_ref</code> and return them, but grouped by <code>$prop_name</code>, also fetching <code>$props_ref</code> and <code>$inherited_props_ref</code></p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return"
>Return</a></h3>

<p>A ref to a hashmap, where keys are property <code>$prop_name</code> values, and values are in turn hashmaps where keys are tag ids, and values are a hashmap with of properties and their values.</p>

<p>Tags with undefined property are with group under &#34;undef&#34; value.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="Example"
>Example</a></h4>

<p>we asks for quality tags, grouped by fix_action, while getting descriptions { &#34;add_nutrition_facts&#34; =&#62; { &#34;en:kcal-does-not-match-other-nutrients&#34; =&#62; { &#34;description:en&#34; =&#62; &#34;Kcal is not matching value computed from other nutriments&#34; }, &#34;en:kcal-does-not-match-kj&#34; =&#62; { &#34;description:en&#34; =&#62; &#34;Kcal is not matching kJ value&#34; }, }, &#34;add_categories&#34; =&#62; { &#34;en:detected-category-baby-milk&#34; { &#34;description:en&#34; =&#62; &#34;Detected category &#8230; may be missing baby milks&#34; } } }</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_all_tags_having_property_($product_ref,_$tagtype,_$prop_name)"
>get_all_tags_having_property ($product_ref, $tagtype, $prop_name)</a></h2>

<p>For each tag of a given field ($tagtype, can be &#34;labels&#34; or &#34;categories&#34;, for example), and a given property ($prop_name, without last column (:). Can be &#34;incompatible_with:en&#34;, for example), return a hash of tagid &#60;-&#62; property_value remark: this DOES NOT handle property inheritance</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return"
>Return</a></h3>

<p>A hash, where keys are tagid and values are property_value</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="Example,_get_all_tags_having_property($product_ref,_&#34;labels&#34;,_&#34;incompatible_with:en&#34;)"
>Example, get_all_tags_having_property($product_ref, &#34;labels&#34;, &#34;incompatible_with:en&#34;)</a></h4>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="add_tag"
>add_tag</a></h2>

<p>Adds a tag to a specified tag type in the product reference if it does not already exist.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$product_ref"
>$product_ref</a></h4>

<p>A hash reference to the product data.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<p>The type of the tag (e.g. categories, labels, allergens).</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagid"
>$tagid</a></h4>

<p>The ID of the tag to add.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>Returns 1 if the tag was added, 0 if it already existed.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="remove_stopwords_from_start_or_end_of_string_(_$tagtype,_$lc,_$string_)"
>remove_stopwords_from_start_or_end_of_string ( $tagtype, $lc, $string )</a></h2>

<p>Remove stopwords (that are specific to each category) from the start or end of a string that has not been normalized. This function differs from remove_stopwords() that works on normalized tags instead of strings and that also removes stopwords in the middle.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<p>The type of the tag (e.g. categories, labels, allergens)</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$lc_-_Language_code"
>$lc - Language code</a></h4>

<p>The language the string is in.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$string_-_string"
>$string - string</a></h4>

<p>The string to remove stopwords from.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="remove_stopwords_(_$tagtype,_$lc,_$tagid_)"
>remove_stopwords ( $tagtype, $lc, $tagid )</a></h2>

<p>Remove stopwords (that are specific to each category) from a normalized tag.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<p>The type of the tag (e.g. categories, labels, allergens)</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$lc_-_Language_code"
>$lc - Language code</a></h4>

<p>The language the tagid is in.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagid_-_normalized_tag"
>$tagid - normalized tag</a></h4>

<p>Lowercased, unaccented depending on language, non-alphanumeric chars turned to dash.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="sanitize_taxonomy_line(_$line_)"
>sanitize_taxonomy_line( $line )</a></h2>

<p>Sanitize a taxonomy line before processing</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="str_$line_-_the_line_read_from_the_file"
>str $line - the line read from the file</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_lc_tagid(_$synonyms_ref,_$lc,_$tagtype,_$tag,_$warning_)"
>get_lc_tagid( $synonyms_ref, $lc, $tagtype, $tag, $warning )</a></h2>

<p>Search for &#34;current tag&#34; (tag at start of line) for a given tag</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="str_$tag_-_tag_string_for_which_we_search"
>str $tag - tag string for which we search</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="reference_to_hash_map_$synonyms_ref_-_ref_to_%synonyms_for_$tagtype"
>reference to hash map $synonyms_ref - ref to %synonyms for $tagtype</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="str_$tagtype_-_tag_type"
>str $tagtype - tag type</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="str_$lc_-_language"
>str $lc - language</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="str_$warning"
>str $warning</a></h4>

<p>An optional prefix to display errors if we had to use stopwords / plurals.</p>

<p>If empty, no warning will be displayed.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="return_str_-_found_current_tagid_or_undef"
>return str - found current tagid or undef</a></h3>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="build_tags_taxonomy(_$tagtype,_$file,_$publish)"
>build_tags_taxonomy( $tagtype, $file, $publish)</a></h2>

<p>Build taxonomy from the taxonomy file</p>

<p>Taxonomy will be stored in global hash maps under the entry $tagtype</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="str_$tagtype_-_the_tagtype"
>str $tagtype - the tagtype</a></h4>

<p>Like &#34;categories&#34;, &#34;ingredients&#34;</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="$file_-_name_of_the_file_to_read_in_taxonomies_folder"
>$file - name of the file to read in taxonomies folder</a></h3>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="$publish_-_if_1,_store_the_result_in_sto"
>$publish - if 1, store the result in sto</a></h3>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="build_all_taxonomies_(_$pubish)"
>build_all_taxonomies ( $pubish)</a></h2>

<p>Build all taxonomies, including the test taxonomy</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Parameters"
>Parameters</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="Publish_STO_file_$publish"
>Publish STO file $publish</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="generate_tags_taxonomy_extract_(_$tagtype,_$tags_ref,_$options_ref,_$lcs_ref)"
>generate_tags_taxonomy_extract ( $tagtype, $tags_ref, $options_ref, $lcs_ref)</a></h2>

<p>Generate an extract of the taxonomy for a specific set of tags.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Parameters"
>Parameters</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="tag_type_$tagtype"
>tag type $tagtype</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="reference_to_a_list_of_tags_ids_$tags_ref"
>reference to a list of tags ids $tags_ref</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="reference_to_a_hash_of_key/value_options"
>reference to a hash of key/value options</a></h4>

<p>Options: - fields: comma separated lists of fields (e.g. &#34;name,description,vegan:en,inherited:vegetarian:en&#34; )</p>

<p>Properties can be requested with their name (e.g.&#34;description&#34;) or name + a specific language (e.g. &#34;vegan:en&#34;). Only properties directly defined for the entry are returned. To include inherited properties from parents, prefix the property with &#34;inherited:&#34; (e.g. &#34;inherited:vegan:en&#34;).</p>

<p>- include_parents: include entries for all direct parents of the requested tags - include_children: include entries for all direct children of the requested tags</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="reference_to_an_array_of_language_codes"
>reference to an array of language codes</a></h4>

<p>Languages for which we want to extract names, synonyms, properties.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="init_taxonomies($die_if_some_taxonomies_cannot_be_loaded_=_0)"
>init_taxonomies($die_if_some_taxonomies_cannot_be_loaded = 0)</a></h2>

<p>Initialize all taxonomies. This function is called when the Tags.pm module is loaded, in order to load all available taxonomies, as most scripts / modules that load Tags.pm expect taxonomies to be loaded.</p>

<p>It is also called by lib/startup_apache.pl startup script with the $die_if_some_taxonomies_cannot_be_loaded set to 1.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Parameters"
>Parameters</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="die_if_some_taxonomies_cannot_be_loaded_$die_if_some_taxonomies_cannot_be_loaded"
>die if some taxonomies cannot be loaded $die_if_some_taxonomies_cannot_be_loaded</a></h4>

<p>If set to 1, the function will die if some taxonomies cannot be loaded.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="canonicalize_taxonomy_tag_link_($target_lc,_$tagtype,_$tag,_$tag_prefix_=_undef)"
>canonicalize_taxonomy_tag_link ($target_lc, $tagtype, $tag, $tag_prefix = undef)</a></h2>

<p>Returns a link to the canonicalized tag</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagid"
>$tagid</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tag_prefix_(optional)"
>$tag_prefix (optional)</a></h4>

<p>Can be - to indicate that the tag is a negative tag</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_tag_image_(_$target_lc,_$tagtype,_$canon_tagid_)"
>get_tag_image ( $target_lc, $tagtype, $canon_tagid )</a></h2>

<p>If an image is associated to a tag, return its relative url, otherwise return undef.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$target_lc"
>$target_lc</a></h4>

<p>The desired language for the image. If an image is not available in the target language, it can be returned in English or in the tag language.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<p>The type of the tag (e.g. categories, labels, allergens)</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$canon_tagid"
>$canon_tagid</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="display_tags_hierarchy_taxonomy_(_$target_lc,_$tagtype,_$tags_ref_)"
>display_tags_hierarchy_taxonomy ( $target_lc, $tagtype, $tags_ref )</a></h2>

<p>Generates a comma separated list of tags in the target language, with links and images.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$target_lc"
>$target_lc</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<p>The type of the tag (e.g. categories, labels, allergens)</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tags_ref"
>$tags_ref</a></h4>

<p>Reference to a list of tags. (usually the *_tags field corresponding to the tag type)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="list_taxonomy_tags_in_language_(_$target_lc,_$tagtype,_$tags_ref_)"
>list_taxonomy_tags_in_language ( $target_lc, $tagtype, $tags_ref )</a></h2>

<p>Generates a comma separated (with a space after the comma) list of tags in the target language.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$target_lc"
>$target_lc</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<p>The type of the tag (e.g. categories, labels, allergens)</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tags_ref"
>$tags_ref</a></h4>

<p>Reference to a list of tags. (usually the *_tags field corresponding to the tag type)</p>

<p>The tags are expected to be in their canonical format.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="canonicalize_taxonomy_tag_or_die_($tag_lc,_$tagtype,_$tag)"
>canonicalize_taxonomy_tag_or_die ($tag_lc, $tagtype, $tag)</a></h2>

<p>Canonicalize a string to check if matches an entry in a taxonomy, and die otherwise.</p>

<p>This function is used during initialization, to check that some initialization data has matching entries in taxonomies.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tag_lc"
>$tag_lc</a></h4>

<p>The language of the string.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<p>The type of the tag (e.g. categories, labels, allergens)</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tag"
>$tag</a></h4>

<p>The string that we want to match to a tag.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$exists_in_taxonomy_ref"
>$exists_in_taxonomy_ref</a></h4>

<p>A reference to a variable that will be assigned 1 if we found a matching taxonomy entry, or 0 otherwise.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>If the string could be matched to an existing taxonomy entry, the canonical id for the entry is returned.</p>

<p>Otherwise, the function dies.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="canonicalize_taxonomy_tag_($tag_lc,_$tagtype,_$tag,_$exists_in_taxonomy_ref_=_undef)"
>canonicalize_taxonomy_tag ($tag_lc, $tagtype, $tag, $exists_in_taxonomy_ref = undef)</a></h2>

<p>Canonicalize a string to check if matches an entry in a taxonomy</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tag_lc"
>$tag_lc</a></h4>

<p>The language of the string.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<p>The type of the tag (e.g. categories, labels, allergens)</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tag"
>$tag</a></h4>

<p>The string that we want to match to a tag.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$exists_in_taxonomy_ref"
>$exists_in_taxonomy_ref</a></h4>

<p>A reference to a variable that will be assigned 1 if we found a matching taxonomy entry, or 0 otherwise.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>If the string could be matched to an existing taxonomy entry, the canonical id for the entry is returned.</p>

<p>Otherwise, we return the string prefixed with the language code (e.g. en:An unknown entry)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_taxonomy_tag_synonyms_(_$tagtype_)"
>get_taxonomy_tag_synonyms ( $tagtype )</a></h2>

<p>Return all entries in a taxonomy.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$canon_tagid"
>$canon_tagid</a></h4>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_values"
>Return values</a></h3>

<p>- undef is the taxonomy does not exist or is not loaded - or a list of all tags</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_taxonomy_tag_synonyms_(_$target_lc,_$tagtype,_$canon_tagid_)"
>get_taxonomy_tag_synonyms ( $target_lc, $tagtype, $canon_tagid )</a></h2>

<p>Return all synonyms (including extended synonyms) in a specific language for a taxonomy entry.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$target_lc"
>$target_lc</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$canon_tagid"
>$canon_tagid</a></h4>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_values"
>Return values</a></h3>

<p>- undef is the taxonomy does not exist or is not loaded, or if the tag does not exist - or a list of all synonyms</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="cached_display_taxonomy_tag_(_$target_lc,_$tagtype,_$canon_tagid_)"
>cached_display_taxonomy_tag ( $target_lc, $tagtype, $canon_tagid )</a></h2>

<p>Return the name of a tag for displaying it to the user. This function builds a cache of the resulting names, in order to reduce execution time. The cache is an ever-growing hash of input parameters. This function should only be used in batch scripts, and not in code called from the Apache mod_perl processes.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$target_lc_-_target_language_code"
>$target_lc - target language code</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$canon_tagid"
>$canon_tagid</a></h4>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_values"
>Return values</a></h3>

<p>The tag translation if it exists in target language, otherwise, the tag id.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="display_taxonomy_tag_(_$target_lc,_$tagtype,_$canon_tagid_)"
>display_taxonomy_tag ( $target_lc, $tagtype, $canon_tagid )</a></h2>

<p>Return the name of a tag for displaying it to the user</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$target_lc_-_target_language_code"
>$target_lc - target language code</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$canon_tagid"
>$canon_tagid</a></h4>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_values"
>Return values</a></h3>

<p>The tag translation if it exists in target language, otherwise, the tag id.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="display_taxonomy_tag_name_(_$target_lc,_$tagtype,_$canon_tagid_)"
>display_taxonomy_tag_name ( $target_lc, $tagtype, $canon_tagid )</a></h2>

<p>A version of display_taxonomy_tag that removes eventual language prefix</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$target_lc_-_target_language_code"
>$target_lc - target language code</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$canon_tagid"
>$canon_tagid</a></h4>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_values"
>Return values</a></h3>

<p>The tag translation if it exists in target language, otherwise, the tag in its primary language</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="canonicalize_tag_link_($tagtype,_$tagid,_$tag_prefix_=_undef)"
>canonicalize_tag_link ($tagtype, $tagid, $tag_prefix = undef)</a></h2>

<p>Return a relative link to a tag page.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagid"
>$tagid</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tag_prefix_(optional)"
>$tag_prefix (optional)</a></h4>

<p>Can be - to indicate that the tag is a negative tag</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="generate_regexps_matching_taxonomy_entries($taxonomy,_$return_type,_$options_ref)"
>generate_regexps_matching_taxonomy_entries($taxonomy, $return_type, $options_ref)</a></h2>

<p>Create regular expressions that will match entries of a taxonomy.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$taxonomy"
>$taxonomy</a></h4>

<p>The type of the tag (e.g. categories, labels, allergens)</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$return_type_-_string"
>$return_type - string</a></h4>

<p>Either &#34;unique_regexp&#34; to get one single regexp for all entries of one language.</p>

<p>Or &#34;list_of_regexps&#34; to get a list of regexps (1 per entry) for each language. For each entry, we return an array with the entry id, and the the regexp for that entry. e.g. [&#39;en:coffee&#39;,&#34;coffee|coffees&#34;]</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$options_ref"
>$options_ref</a></h4>

<p>A reference to a hash to enable options to indicate how to match:</p>

<p>- add_simple_plurals : in some languages, like French, we will allow an extra &#34;s&#34; at the end of entries - add_simple_singulars: same with removing the &#34;s&#34; at the end of entries - match_space_with_dash: spaces or dashes in entries will match either a space or a dash (e.g. &#34;South America&#34; will match &#34;South-America&#34;)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="cmp_taxonomy_tags_alphabetically($tagtype,_$target_lc,_$a,_$b)"
>cmp_taxonomy_tags_alphabetically($tagtype, $target_lc, $a, $b)</a></h2>

<p>Comparison function for canonical tags entries in a taxonomy.</p>

<p>To be used as a sort function in a sort() call.</p>

<p>Each tag is converted to a string, by priority: 1 - the tag name in the target language 2 - the tag name in the xx language 3 - the tag id</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<p>The type of the tag (e.g. categories, labels, allergens)</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$target_lc"
>$target_lc</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$a"
>$a</a></h4>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$b"
>$b</a></h4>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="load_knowledge_content()"
>load_knowledge_content()</a></h2>

<p>Load all knowledge content in memory. The content is in /lang/[flavor]?/[lc]/knowledge_panels/[tagtype]/[tagid]_[cc|world].html</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_knowledge_content_($tagtype,_$tagid,_$target_lc,_$target_cc)"
>get_knowledge_content ($tagtype, $tagid, $target_lc, $target_cc)</a></h2>

<p>Fetch knowledge content as HTML about additive, categories,...</p>

<p>This content is used in knowledge panels.</p>

<p>Content is stored as HTML files in `${lang_dir}/${target_lc}/knowledge_panels/${tagtype}`. We first check the existence of a file specific to the country specified by `${target_cc}`, with a fallback on `world` otherwise. This is useful to have a more specific description for some countries compared to the `world` base content.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<p>The type of the tag (e.g. categories, labels, allergens)</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagid"
>$tagid</a></h4>

<p>The tag we want to match, with language prefix (ex: `en:e255`).</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$target_lc"
>$target_lc</a></h4>

<p>The user language as a 2-letters code (fr, it,...)</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$target_cc"
>$target_cc</a></h4>

<p>The user country as a 2-letters code (fr, it, ch) or `world`</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>If a content exists for the tag type, tag value, language code and country code, return the HTML text, return undef otherwise.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_property_to_tag_mapping_table_($tagtype,_$property)"
>create_property_to_tag_mapping_table ($tagtype, $property)</a></h2>

<p>Given a tag type and a property name, create a mapping table from the property to the tag id.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$tagtype"
>$tagtype</a></h4>

<p>The type of the tag (e.g. categories, labels, allergens)</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="$property"
>$property</a></h4>

<p>The property name (e.g. &#34;gpc_category_code:en:&#34;)</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>A hash reference with the tag id as key and the property value as value.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
