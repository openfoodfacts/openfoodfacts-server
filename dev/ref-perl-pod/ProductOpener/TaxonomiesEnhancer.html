<html><head><title>ProductOpener::TaxonomiesEnhancer</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="simple.min" type="text/css" href="../simple.min.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.43,
  using Pod::Simple::PullParser v3.43,
  under Perl v5.038002 at Wed Mar 26 11:19:48 2025 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#flatten_ingredients_(_ingredients_)'>flatten_ingredients ( ingredients )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#ingredients'>ingredients</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#parse_ingredients_for_language_(_ingredients_hash%2C_key_)'>parse_ingredients_for_language ( ingredients_hash, key )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#ingredients_hash'>ingredients_hash</a>
        <li class='indexItem indexItem4'><a href='#key'>key</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#not_enough_known_ingredients_(_ingredients1%2C_ingredients2_)'>not_enough_known_ingredients ( ingredients1, ingredients2 )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#ingredients1'>ingredients1</a>
        <li class='indexItem indexItem4'><a href='#ingredients2'>ingredients2</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#detect_missing_stop_words_before_list_(_ingredients1%2C_ingredients2%2C_lang1%2C_lang2%2C_missing_stop_words_before_)'>detect_missing_stop_words_before_list ( ingredients1, ingredients2, lang1, lang2, missing_stop_words_before )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#ingredients1'>ingredients1</a>
        <li class='indexItem indexItem4'><a href='#ingredients2'>ingredients2</a>
        <li class='indexItem indexItem4'><a href='#lang1'>lang1</a>
        <li class='indexItem indexItem4'><a href='#lang2'>lang2</a>
        <li class='indexItem indexItem4'><a href='#missing_stop_words_before'>missing_stop_words_before</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#get_ingredient_index_(_ingredients%2C_ingredient_id_)'>get_ingredient_index ( ingredients, ingredient_id )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#ingredients'>ingredients</a>
        <li class='indexItem indexItem4'><a href='#ingredient_id'>ingredient_id</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#detect_missing_stop_words_after_list_(_ingredients1%2C_ingredients2%2C_lang1%2C_lang2%2C_missing_stop_words_after_)'>detect_missing_stop_words_after_list ( ingredients1, ingredients2, lang1, lang2, missing_stop_words_after )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#ingredients1'>ingredients1</a>
        <li class='indexItem indexItem4'><a href='#ingredients2'>ingredients2</a>
        <li class='indexItem indexItem4'><a href='#lang1'>lang1</a>
        <li class='indexItem indexItem4'><a href='#lang2'>lang2</a>
        <li class='indexItem indexItem4'><a href='#missing_stop_words_after'>missing_stop_words_after</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#remove_duplicates_(_%40array_)'>remove_duplicates ( @array )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#%40array'>@array</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#find_smallest_value_key_(_hashmap_)'>find_smallest_value_key ( hashmap )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#hashmap'>hashmap</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#get_sorted_strings_(_string1%2C_string2_)'>get_sorted_strings ( string1, string2 )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#string1'>string1</a>
        <li class='indexItem indexItem4'><a href='#string2'>string2</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#ingredients1'>ingredients1</a>
        <li class='indexItem indexItem4'><a href='#ingredients2'>ingredients2</a>
        <li class='indexItem indexItem4'><a href='#lang1'>lang1</a>
        <li class='indexItem indexItem4'><a href='#lang2'>lang2</a>
        <li class='indexItem indexItem4'><a href='#missing_ingredients'>missing_ingredients</a>
        <li class='indexItem indexItem4'><a href='#ingredients_typo'>ingredients_typo</a>
        <li class='indexItem indexItem4'><a href='#mismatch_in_taxonomy'>mismatch_in_taxonomy</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#check_ingredients_between_languages_(_product_ref_)'>check_ingredients_between_languages ( product_ref )</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Arguments'>Arguments</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#product_ref'>product_ref</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#Return_value'>Return value</a>
    </ul>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>ProductOpener::TaxonomiesEnhancer - analyze ingredients and other fields to enrich the taxonomies</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p><code>ProductOpener::TaxonomiesEnhancer</code> analyze analyze ingredients and other fields to enrich the taxonomies</p>

<pre>    use ProductOpener::TaxonomiesEnhancer qw/:all/;

        [..]

        check_ingredients_between_languages($product_ref);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>[..]</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="flatten_ingredients_(_ingredients_)"
>flatten_ingredients ( ingredients )</a></h2>

<p>This function recursively flattens a nested list of ingredients. If an ingredient contains sub-ingredients, they are flattened into a single-level array.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="ingredients"
>ingredients</a></h4>

<p>An array reference of ingredients that may contain nested sub-ingredients.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>An array of flattened ingredients, each represented as a hash reference.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="parse_ingredients_for_language_(_ingredients_hash,_key_)"
>parse_ingredients_for_language ( ingredients_hash, key )</a></h2>

<p>This function parses and flattens the ingredient list for a specific language based on the provided key.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="ingredients_hash"
>ingredients_hash</a></h4>

<p>A hash reference to the product data containing the ingredient text for various languages.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="key"
>key</a></h4>

<p>A string representing the language-specific ingredient text key (e.g., &#34;ingredients_text_cs&#34;).</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>This function does not return a value but modifies the product reference to store the flattened ingredient list under a new key (e.g., &#34;ingredients_cs&#34;).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="not_enough_known_ingredients_(_ingredients1,_ingredients2_)"
>not_enough_known_ingredients ( ingredients1, ingredients2 )</a></h2>

<p>This function checks if all or a certain percentage of ingredients in the first language (reference) overlap with ingredients in second language (to analyze).</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="ingredients1"
>ingredients1</a></h4>

<p>An array reference of ingredients in the first language (reference).</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="ingredients2"
>ingredients2</a></h4>

<p>An array reference of ingredients in the second language (to analyze).</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>Returns 1 if the overlap of ingredients between the two lists is below a certain threshold, otherwise returns 0.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="detect_missing_stop_words_before_list_(_ingredients1,_ingredients2,_lang1,_lang2,_missing_stop_words_before_)"
>detect_missing_stop_words_before_list ( ingredients1, ingredients2, lang1, lang2, missing_stop_words_before )</a></h2>

<p>This function detects missing stop words before the first known ingredient in a list of ingredients.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="ingredients1"
>ingredients1</a></h4>

<p>An array reference of ingredients in the first language (reference).</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="ingredients2"
>ingredients2</a></h4>

<p>An array reference of ingredients in the second language (to analyze).</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="lang1"
>lang1</a></h4>

<p>A string representing the language code for the first language.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="lang2"
>lang2</a></h4>

<p>A string representing the language code for the second language.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="missing_stop_words_before"
>missing_stop_words_before</a></h4>

<p>A hash reference to store the missing stop words before the first known ingredient.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>This function does not return a value but modifies the `missing_stop_words_before` hash reference to store the missing stop words.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_ingredient_index_(_ingredients,_ingredient_id_)"
>get_ingredient_index ( ingredients, ingredient_id )</a></h2>

<p>This function finds the index of a specific ingredient in a list of ingredients based on its ID.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="ingredients"
>ingredients</a></h4>

<p>An array reference of ingredients, where each ingredient is represented as a hash reference.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="ingredient_id"
>ingredient_id</a></h4>

<p>A string representing the ID of the ingredient to find.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>Returns the index of the ingredient if found, otherwise returns -1.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="detect_missing_stop_words_after_list_(_ingredients1,_ingredients2,_lang1,_lang2,_missing_stop_words_after_)"
>detect_missing_stop_words_after_list ( ingredients1, ingredients2, lang1, lang2, missing_stop_words_after )</a></h2>

<p>This function detects missing stop words after the last known ingredient in a list of ingredients.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="ingredients1"
>ingredients1</a></h4>

<p>An array reference of ingredients in the first language (reference).</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="ingredients2"
>ingredients2</a></h4>

<p>An array reference of ingredients in the second language (to analyze).</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="lang1"
>lang1</a></h4>

<p>A string representing the language code for the first language.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="lang2"
>lang2</a></h4>

<p>A string representing the language code for the second language.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="missing_stop_words_after"
>missing_stop_words_after</a></h4>

<p>A hash reference to store the missing stop words after the last known ingredient.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>This function does not return a value but modifies the `missing_stop_words_after` hash reference to store the missing stop words.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="remove_duplicates_(_@array_)"
>remove_duplicates ( @array )</a></h2>

<p>This function removes duplicate elements from an array.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="@array"
>@array</a></h4>

<p>An array of elements from which duplicates need to be removed.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>Returns an array with duplicate elements removed.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="find_smallest_value_key_(_hashmap_)"
>find_smallest_value_key ( hashmap )</a></h2>

<p>This function finds the key with the smallest value in a hashmap. If multiple keys have the same smallest value, it returns the first key in alphabetical order.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="hashmap"
>hashmap</a></h4>

<p>A hash reference where the keys are strings and the values are numeric.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>Returns the key with the smallest value. If multiple keys have the same smallest value, returns the first key in alphabetical order.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_sorted_strings_(_string1,_string2_)"
>get_sorted_strings ( string1, string2 )</a></h2>

<p>This function returns two strings in alphabetical order.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="string1"
>string1</a></h4>

<p>A string to be compared.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="string2"
>string2</a></h4>

<p>A string to be compared.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>Returns a list of two strings sorted in lexicographical order.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'

>detect_missing_ingredients ( ingredients1, ingredients2, lang1, lang2, missing_ingredients, ingredients_typo, mismatch_in_taxonomy )</a></h2>

<p>This function detects missing ingredients and potential typos between two lists of ingredients in different languages.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="ingredients1"
>ingredients1</a></h4>

<p>An array reference of ingredients in the first language (reference).</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="ingredients2"
>ingredients2</a></h4>

<p>An array reference of ingredients in the second language (to analyze).</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="lang1"
>lang1</a></h4>

<p>A string representing the language code for the first language.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="lang2"
>lang2</a></h4>

<p>A string representing the language code for the second language.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="missing_ingredients"
>missing_ingredients</a></h4>

<p>A hash reference to store missing ingredients.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="ingredients_typo"
>ingredients_typo</a></h4>

<p>A hash reference to store potential typos in ingredients.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="mismatch_in_taxonomy"
>mismatch_in_taxonomy</a></h4>

<p>A hash reference to store mismatches in the taxonomy between the two languages.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>This function does not return a value but modifies the `missing_ingredients`, `ingredients_typo`, and `mismatch_in_taxonomy` hash references to store the detected issues.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="check_ingredients_between_languages_(_product_ref_)"
>check_ingredients_between_languages ( product_ref )</a></h2>

<p>This function extracts data for each language from the provided product reference. It then detects failed extractions (missing stop words) and identifies missing translations.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Arguments"
>Arguments</a></h3>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="product_ref"
>product_ref</a></h4>

<p>A reference to the product data, which is expected to be a hash reference containing the necessary information.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Return_value"
>Return value</a></h3>

<p>This function does not return any value. It performs the extraction and detection internally.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
