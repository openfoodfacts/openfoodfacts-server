{
    "level" :"info",
    "topics": [
        "environment"
    ],
    "title_element": {
        "title": "Eco-Score extended",
        "subtitle": "[% lang('categories_s') FILTER ucfirst %][% sep %]: [% panel.agribalyse_category_name.dquote %]",
        "type": "grade",
        "icon_url": "[% static_subdomain %]/images/icons/dist/scale-balance.svg",
        "icon_color_from_evaluation": true,        
    },
    "elements": [
        {
            "element_type": "text",
            "text_element": {
                "text_type": "summary",
                "html": `eco-score extended panel

                climate_change: [% panel.climate_change %]
                ef_score: [% panel.ef_score %]

                [% IF panel.ecoscore_extended_data_for_category.defined %]
                    category_id: [% panel.ecoscore_extended_data_for_category.category_id %]
                    climate_change average: [% panel.ecoscore_extended_data_for_category.climate_change %]
                [% END %]

                    `
            }
        },
        {
            "element_type": "table",
            "table_element": {
                "id": "ecoscore_lca_impacts_by_stages_table",
                "table_type": "percents",
                "title": "[% lang('ecoscore_impact_detail_by_stages') %]",
                "columns": [
                    {
                        "text": "Agribalyse",
                        "type": "text",
                    },
                    {
                        "text": "Estimator",
                        "type": "text",
                    }
                ],
                "rows": [
                    [% FOREACH ingredients IN product.ecoscore_extended_data.impact.max_confidence_recipe %]
                    {
                        "id": "[% step %]",
                        "values": [
                            {
                                "text": "[% display_taxonomy_tag('ingredients', ingredients.id) %] - [% ingredients.quantity %]"
                            },
                            {
                                [% ef_step = "ef_$step" %]
                                "text": "[% (100 * product.ecoscore_data.agribalyse.$ef_step / product.ecoscore_data.agribalyse.ef_total) FILTER format('%.1f'); %] %",
                                "percent": [% (100 * product.ecoscore_data.agribalyse.$ef_step / product.ecoscore_data.agribalyse.ef_total) %]
                            }
                        ],
                    },
                    [% END %]
                ]
            }
        }
    ]
}
