{
    "level": "info",
    "topics": [
        "environment"
    ],
    "title_element": {
        "name": "[% edq(lang('forest_footprint')) %]",
        "title": "[% edq(lang("attribute_forest_footprint_${product.forest_footprint_data.grade}_title")) %]",
        "subtitle": "[% edq(lang("attribute_forest_footprint_${product.forest_footprint_data.grade}_description_short")) %]",        
        "icon_url": "[% static_subdomain %]/images/attributes/dist/forest-footprint-[% product.forest_footprint_data.grade %].svg",
        "type": "grade",
        "grade": "[% product.forest_footprint_data.grade %]"        
    },
    "elements": [
        {
            "element_type": "text",
            "text_element": {
                "type": "summary",
                "html": `
                <p><strong>[% edq(lang("forest_footprint")) %]</strong></p>
                <p>[% edq(lang("forest_footprint_one_line_explanation")) %]</p>
                `
            }
        },
        [% IF product.forest_footprint_data.ingredients_from_soy_count %]
        {
            "element_type": "table",
            "table_element": {
                "id": "forest_footprint_soy_table",
                "title": "[% edq(lang("ingredients_requiring_soy")) %]",
                "columns": [
                    {
                        "text": "[% edq(lang("ingredients_s")) FILTER ucfirst %]",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("type")) %]",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("percent_in_product")) %]",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("processing_factor")) %]<br><span style=\"font-weight:normal\">([% edq(lang("percent_of_food_after_processing")) %])</span>",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("soy_feed_factor")) %]<br><span style=\"font-weight:normal\">([% edq(lang("kg_of_soy_per_kg_of_food")) %])</span>",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("soy_yield")) %]<br><span style=\"font-weight:normal\">([% edq(lang("kg_of_soy_per_square_meter")) %])</span>",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("deforestation_risk")) %]<br><span style=\"font-weight:normal\">(%)</span>",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("forest_footprint")) %]<br><span style=\"font-weight:normal\">([% edq(lang("square_meters_per_kg_of_food")) %])</span>",
                        "type": "text"
                    }
                ],
                "rows": [
                    [% FOREACH ingredient IN product.forest_footprint_data.ingredients %]
                    [% IF ingredient.category_type == "ingredients_from_soy" %]
                    {
                        "values": [
                            {
                                "text": "[% display_taxonomy_tag(ingredient.tag_type, ingredient.tag_id) %]"
                            },
                            {
                                "text": "[% ingredient.type.name %]"
                            },
                            {
                                "text": "[% round(ingredient.percent) %] %"
                            },
                            {
                                "text": "[% round(ingredient.processing_factor * 100) %] %"
                            },
                            {
                                "text": "[% ingredient.type.soy_feed_factor %]"
                            },
                            {
                                "text": "[% ingredient.type.soy_yield %]"
                            },
                            {
                                "text": "[% round(ingredient.type.deforestation_risk * 100) %] %"
                            },
                            {
                                "text": "[% ingredient.footprint_per_kg FILTER format("%.2f"); %]"
                            }
                        ]
                    },
                    [% END %]
                    [% END %]
                ]
            }
        },
        [% END %]
        [% IF product.forest_footprint_data.ingredients_count %]
        {
            "element_type": "table",
            "table_element": {
                "id": "forest_footprint_ingredients_table",
                "title": "[% edq(lang("ingredients_causing_deforestation")) %]",
                "columns": [
                    {
                        "text": "[% edq(lang("ingredients_s")) FILTER ucfirst %]",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("percent_in_product")) %]",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("categories_s")).ucfirst %]",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("processing_factor")) %]",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("origin")) %]",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("origin_forest_footprint")) %]",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("labels_s")).ucfirst %]",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("deforestation_risk")) %]<br><span style=\"font-weight:normal\">(%)</span>",
                        "type": "text"
                    },
                    {
                        "text": "[% edq(lang("forest_footprint")) %]<br><span style=\"font-weight:normal\">([% edq(lang("square_meters_per_kg_of_food")) %])</span>",
                        "type": "text"
                    }
                ],
                "rows": [
                    [% FOREACH ingredient IN product.forest_footprint_data.ingredients %]
                    [% IF ingredient.category_type == "ingredients" %]
                    {
                        "values": [
                            {
                                "text": "[% display_taxonomy_tag(ingredient.tag_type, ingredient.tag_id) %]"
                            },
                            {
                                "text": "[% round(ingredient.percent) %] %"
                            },
                            {
                                "text": "[% display_taxonomy_tag("ingredients", "en:" _ ingredient.category).ucfirst%]"
                            },
                            {
                                "text": "[% ingredient.processing_factor %]"
                            },
                            {
                                "text": "[% IF ingredient.origin != 'en:other' %][% display_taxonomy_tag('origins', ingredient.origin) %][% END %]"
                            },
                            {
                                "text": "[% ingredient.origin_footprint_per_kg %]"
                            },
                            {
                                "text": "[% IF ingredient.label %][% display_taxonomy_tag('labels', ingredient.label) %][% END %]"
                            },
                            {
                                "text": "[% round(ingredient.deforestation_risk) %] %"
                            },
                            {
                                "text": "[% ingredient.footprint_per_kg FILTER format("%.2f"); %]"
                            }
                        ]
                    },
                    [% END %]
                    [% END %]
                ]
            }
        },
        [% END %]
        {
            "element_type": "text",
            "text_element": {
                "type": "summary",
                "html": `
                    <h3>[% edq(lang("total_forest_footprint")) %]</h3>
                    <p><strong>[% product.forest_footprint_data.footprint_per_kg FILTER format("%.2f"); %] [% edq(lang("square_meters_per_kg_of_food")) %]</strong></p>
                `
            }
        }
    ]
}