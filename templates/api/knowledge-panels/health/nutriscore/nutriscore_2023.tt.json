{
    "level": "info",
    "topics": [
        "health"
    ],
    "title_element": {
        "icon_url": "[% static_subdomain %]/images/attributes/dist/nutriscore-[% panel.nutriscore_grade %]-new-formula-[% IF lc == "fr" %][% lc %][% ELSE %]en[% END %].svg",
        "title": "[% panel.title %]",
        "subtitle": "[% panel.subtitle %]",
        "type": "grade",
        "grade": "[% panel.nutriscore_grade %]",
    },
    "elements": [
        // Explanation of Nutri-Score
        {
            "element_type": "panel",
            "panel_element": {
                "panel_id": "nutriscore_description",
            },
        },        
        // Display warnings
        [% IF panel.nutriscore_warnings %]
            [% FOREACH warning IN panel.nutriscore_warnings %]
            {
                "element_type": "text",
                "text_element": {
                    "type": "warning",
                    "html": `[% warning %]
                    `,
                }
            },
            [% END %]
        [% END %]
        // Display actions if we are missing data to compute the Nutri-Score
        [% IF panel.nutriscore_unknown_reason %]
        {
            "element_type": "action",
            "action_element": {
                "html": `[% lang("actions_to_compute_nutriscore") %]`,
                "actions": [
                    [% IF panel.nutriscore_unknown_reason == "missing_category" %]
                        "add_categories"
                    [% ELSIF panel.nutriscore_unknown_reason == "missing_nutrition_data" %]
                        "add_nutrition_facts"
                    [% ELSIF panel.nutriscore_unknown_reason == "missing_category_and_nutrition_data" %]
                        "add_categories",
                        "add_nutrition_facts"
                    [% END %]
                ]
            }
        },        
        [% END %]
        // Start with negative points first, as the positive points depend on negative points
        {
            "element_type": "panel_group",
            "panel_group_element": {
                "title": "[% lang('nutriscore_negative_points') %][% sep %]: [% product.nutriscore.2023.data.negative_points %]/[% product.nutriscore.2023.data.negative_max %]",
                "evaluation": "bad",
                "icon_url": "[% static_subdomain %]/images/icons/dist/circle-minus.svg",
                "icon_size": "small",
                "icon_color_from_evaluation": true,
                "panel_ids": [
                    [% FOREACH component IN product.nutriscore.2023.data.components.negative %]
                        "nutriscore_component_[% component.id %]",
                    [% END %]
                ],
            },
        },          
        {
            "element_type": "panel_group",
            "panel_group_element": {
                "title": "[% lang('nutriscore_positive_points') %][% sep %]: [% product.nutriscore.2023.data.positive_points %]/[% product.nutriscore.2023.data.positive_max %]",
                "evaluation": "good",
                "icon_url": "[% static_subdomain %]/images/icons/dist/circle-plus.svg",
                "icon_size": "small",
                "icon_color_from_evaluation": true,
                "panel_ids": [
                    [% FOREACH component IN product.nutriscore.2023.data.components.positive %]
                        "nutriscore_component_[% component.id %]",
                    [% END %]
                ],
            },
        },       
        {
            "element_type": "text",
            "text_element": {
                "html": `
[% IF product.nutriscore.2023.data.is_beverage %]
    <p>[% lang('nutriscore_is_beverage') %]</p>
[% ELSE %]
    <p>[% lang('nutriscore_is_not_beverage') %]</p>
[% END %]
[% IF product.nutriscore.2023.data.is_water %]
    <p>[% lang('nutriscore_is_water') %]</p>
[% END %]
[% IF product.nutriscore.2023.data.is_fat_oil_nuts_seeds %]
    <p>[% lang('nutriscore_is_fat_oil_nuts_seeds') %]</p>
[% END %]
[% IF product.nutriscore.2023.data.is_cheese %]
    <p>[% lang('nutriscore_is_cheese') %]</p>
[% END %]
[% IF product.nutriscore.2023.data.is_red_meat_product %]
    <p>[% lang('nutriscore_is_red_meat_product') %]</p>
[% END %]
<p>[% lang("nutriscore_count_proteins_reason_" _ product.nutriscore.2023.data.count_proteins_reason )%]</p>

<p>
  <strong>[% lang('nutriscore_score') %][% sep %]: [% product.nutriscore.2023.score %]</strong>
  ([% product.nutriscore.2023.data.negative_points %] - [% product.nutriscore.2023.data.positive_points %])
</p>
<p><strong>[% lang('nutriscore_grade') %][% sep %]: [% product.nutriscore.2023.grade FILTER ucfirst %]</strong></p>                
                `,
            }
        },
        {
            "element_type": "text",
            "text_element": {
                "html": `
<p>&rarr; <a href="/nutriscore">[% lang('nutriscore_learn_more') %]</a></p>
`
            },
        },
    ]
}
